"use strict";(()=>{var e={};e.id=5686,e.ids=[5686],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},69036:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>R,patchFetch:()=>N,requestAsyncStorage:()=>h,routeModule:()=>b,serverHooks:()=>x,staticGenerationAsyncStorage:()=>S});var s={};a.r(s),a.d(s,{GET:()=>g,POST:()=>m});var r=a(30633),o=a(86488),n=a(13342),l=a(90223),i=a(92048),u=a.n(i),d=a(55315);let c=a.n(d)().join(process.cwd(),"dslr-status.json"),p={isConnected:!1,isProcessing:!1,totalUploaded:0,failedUploads:0,lastUpload:null,watchFolder:"win32"===process.platform?"C:/DCIM/100NIKON":"/media/DCIM/100NIKON",eventId:"",uploaderName:"Official Photographer",queueSize:0,uploadSpeed:0,serviceRunning:!1,lastHeartbeat:null,cameraModel:"Auto-detect",autoDetect:!0,backupEnabled:!0,notificationsEnabled:!0,watermarkEnabled:!1};async function g(){try{let e=function(){try{if(u().existsSync(c)){let e=u().readFileSync(c,"utf8"),t=JSON.parse(e),a=new Date().getTime(),s=t.lastHeartbeat?new Date(t.lastHeartbeat).getTime():0,r=a-s<3e4;return{...t,...f,serviceRunning:r,isConnected:r&&t.isConnected,totalUploaded:t.totalUploaded||f.totalUploaded,failedUploads:t.failedUploads||f.failedUploads,lastUpload:t.lastUpload||f.lastUpload}}}catch(e){console.error("Error reading DSLR status file:",e)}return{...p,...f}}();return l.NextResponse.json({success:!0,...e})}catch(e){return console.error("Error getting DSLR status:",e),l.NextResponse.json({success:!1,error:"Failed to get DSLR status"},{status:500})}}let f={isConnected:!1,isProcessing:!1,totalUploaded:0,failedUploads:0,lastUpload:null,watchFolder:"C:/DCIM/100NIKON",eventId:"",uploaderName:"Official Photographer",queueSize:0,uploadSpeed:0,serviceRunning:!1,lastHeartbeat:null,cameraModel:"NIKON_D7100",autoDetect:!0,backupEnabled:!0,notificationsEnabled:!0,watermarkEnabled:!1};async function m(e){try{let{action:t,settings:a}=await e.json();switch(t){case"pause":f.isProcessing=!1;break;case"resume":f.isProcessing=!0;break;case"update_settings":a&&(f={...f,...a,lastHeartbeat:new Date().toISOString()},console.log("âœ… DSLR settings updated in memory:",a));break;default:return l.NextResponse.json({success:!1,error:"Invalid action"},{status:400})}return l.NextResponse.json({success:!0,...f})}catch(e){return console.error("Error updating DSLR status:",e),l.NextResponse.json({success:!1,error:"Failed to update DSLR status"},{status:500})}}let b=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dslr/status/route",pathname:"/api/dslr/status",filename:"route",bundlePath:"app/api/dslr/status/route"},resolvedPagePath:"/home/ubuntu/stable/src/app/api/dslr/status/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:S,serverHooks:x}=b,R="/api/dslr/status/route";function N(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:S})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[2782,606],()=>a(69036));module.exports=s})();